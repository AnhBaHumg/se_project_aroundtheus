!function(){"use strict";class e{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this._cardID=e.cardID,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteSubmit=r,this._handleLikeClick=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardTrash.addEventListener("click",(()=>{this._handleDeleteSubmit(this._id,this)})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}isLiked(){return this.isLiked}_setLikes(){this._isLiked?this._likeButton.classList.add("card__like-button-active"):this._likeButton.classList.remove("card__like-button-active")}handleDeleteSubmit(){const e=this.cardData;handleDeleteButton(e)}handleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button-active")};handleDeleteCard=()=>{this._element.remove(),this._element=null};getView(){return this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".card__like-button"),this._cardTrash=this._element.querySelector(".card__trash-button"),this._cardImageEl=this._element.querySelector(".card__image"),this._cardImageEl.src=this._link,this._cardImageEl.alt=`Photo of ${this._name}`,this._element.querySelector(".card__name").textContent=this._name,this._setLikes(),this._setEventListeners(),this._element}getID(){return this._id()}}class t{constructor(e,t){this._formEl=e,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._submitButton=this._formEl.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}changeButtonState(){let e=!1;this._inputElements.forEach((t=>{t.validity.valid||(e=!0)})),e?this._disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputElements=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkValidity(e),this.changeButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault(),this._disableButton()})),this._setEventListeners()}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class r extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputEls=[...this._popupForm.querySelectorAll(".modal__input")],this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}setEventListeners(){this._popupElement.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}close(){this._popupForm.reset(),super.close()}_getInputValues(){const e={};return this._inputEls.forEach((t=>{e[t.name]=t.value})),e}setLoading(e){this._submitButton.textContent=e?"loading...":this._submitButtonText}renderLoading(){const e=document.createElement("img");return e.src=imageSrc,e}loadImage(){this.image=image,this._popupForm.append(image)}}class i{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(`.${t}`)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}const o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},n=document.querySelector("#add-card-modal").querySelector(".modal__form"),a=document.querySelector("#profile-edit-modal"),l={cardListEl:document.querySelector(".cards__list"),addCardForm:document.querySelector("#add-card-form"),profileEditButton:document.querySelector("#profile-edit-button"),profileCloseButton:"#profile-close-button",addCardCloseButton:"#addcard-close-button",profileTitle:document.querySelector(".profile__title"),profileDescription:document.querySelector(".profile__description"),addNewCardButton:document.querySelector(".profile__add-button"),profileTitleInput:document.querySelector("#profile-title-input"),profileDescriptionInput:document.querySelector("#profile-description-input"),cardTitleInput:"#title-card-input",cardUrlInput:"#url-image-input",popupModal:document.querySelector("#image-popup"),popupImage:"#modal-image-popup",popupTitle:"#modal-title-popup",popupImageModalClose:document.querySelector("#image-popup-close-button"),deleteCardPopup:"#delete-card-modal"},d=new class{constructor(e){let{headers:t,baseUrl:s}=e;this.baseUrl=s,this.headers=t}_checkResponse(e){if(!e.ok)throw console.error(`HTTP error! Status: ${e.status}, Text: ${e.statusText}`),new Error(`HTTP error! Status: ${e.status}, Text: ${e.statusText}`);return e.json()}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this.baseUrl}/cards`,{headers:this.headers})}addNewCard(e){return this._request(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify(e)})}deleteCard(e){return this._request(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers})}likeCard=e=>this._request(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers});removeLike(e){return this._request(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers})}getUserInfo(){return this._request(`${this.baseUrl}/users/me`,{headers:this.headers})}editUserInfo(e){return this._request(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.description})})}updateAvatar(e){return this._request(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a5172d76-7206-4bb6-b609-2e8e17b83724","Content-Type":"application/json"}});function c(e){E.open(e)}function u(t){return new e(t,"#card-template",c,v,_).getView()}const h=new t(a,o),p=new t(n,o);function _(e){e.isLiked?d.removeLike(e._id).then((()=>{e.handleLikeIcon()})).catch((e=>console.error(e))):d.likeCard(e._id).then((()=>{e.handleLikeIcon()})).catch((e=>console.error(e)))}h.enableValidation(),p.enableValidation();const m=new r("#profile-edit-modal",(function(e){m.setLoading(!0),d.editUserInfo(e).then((()=>{S.setUserInfo(e.name,e.description),m.close()})).catch((e=>{console.error(e)})).finally((()=>{m.setLoading(!1)}))}));m.setEventListeners(),l.profileEditButton.addEventListener("click",(function(){const e=S.getUserInfo();l.profileTitleInput.value=e.name,l.profileDescriptionInput.value=e.description,m.open()})),l.addNewCardButton.addEventListener("click",(function(){g.open()}));const E=new class extends s{constructor(e){super({popupSelector:e}),this._popupImage=this._popupElement.querySelector(".modal__image-popup"),this._popupTitle=this._popupElement.querySelector(".modal__title-popup")}open(e){let{name:t,link:s}=e;this._popupImage.src=s,this._popupImage.alt=t,this._popupTitle.textContent=t,super.open()}}("#image-popup");let f;E.setEventListeners(),d.getInitialCards().then((e=>{f=new i({items:e,renderer:e=>{const t=u(e);f.addItem(t)}},"cards__list"),f.renderItems()})).catch((e=>{console.error(e)})),d.getUserInfo().then((e=>{S.setUserInfo(e.name,e.description),S.setAvatar(e.avatar)})).catch((e=>{console.error(e)}));const S=new class{constructor(e,t,s){this._titleElement=document.querySelector(e),this._descriptionElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._titleElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(e,t){this._titleElement.textContent=e,this._descriptionElement.textContent=t}setAvatar(e){this._avatarElement.src=e}}(".profile__title",".profile__description",".profile__image"),b=new class extends s{constructor(e){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form")}setSubmitAction(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}("#delete-card-modal");function v(e,t){b.open(),b.setSubmitAction((()=>{d.deleteCard(e).then((()=>{t.handleDeleteCard(),b.close()})).catch((e=>{console.log(e)})).finally((()=>{}))}))}b.setEventListeners();const L=new r("#profile-image-modal",(e=>{L.setLoading(!0),d.updateAvatar(e.link).then((e=>{S.setAvatar(e.avatar),L.close()})).catch((e=>{console.error(e)})).finally((()=>{L.setLoading(!1)}))}));document.querySelector("#avatar-edit-button").addEventListener("click",(()=>{L.open()})),L.setEventListeners();const g=new r("#add-card-modal",(function(e){g.setLoading(!0),d.addNewCard(e).then((e=>{u(e),l.addCardForm.reset(),p.changeButtonState(),g.close()})).catch((e=>{console.error(e)})).finally((()=>{g.setLoading(!1)}))}));g.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBUUMsTUFBTWtDLEVBQUksSUFHbkJJLFNBQVEsS0FDUEUsRUFBVXZGLFlBQVcsRUFBTSxHQUVqQyxJQUNBdUYsRUFBVXJHLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC4uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZURlbGV0ZVN1Ym1pdCwgaGFuZGxlTGlrZUNsaWNrKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRJRCA9IGRhdGEuY2FyZElEO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZVN1Ym1pdCA9IGhhbmRsZURlbGV0ZVN1Ym1pdDtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vLmNhcmRfX2xpa2UtYnV0dG9uXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvLy5jYXJkX190cmFzaC1idXR0b25cclxuICAgIHRoaXMuX2NhcmRUcmFzaC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVTdWJtaXQodGhpcy5faWQsIHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8uY2FyZF9faW1hZ2VcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaXNMaWtlZDtcclxuICB9XHJcblxyXG4gIF9zZXRMaWtlcygpIHtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uLWFjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uLWFjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZVN1Ym1pdCgpIHtcclxuICAgIGNvbnN0IGNhcmRJRCA9IHRoaXMuY2FyZERhdGE7XHJcbiAgICBoYW5kbGVEZWxldGVCdXR0b24oY2FyZElEKTtcclxuICB9XHJcblxyXG4gIGhhbmRsZUxpa2VJY29uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b24tYWN0aXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlRGVsZXRlQ2FyZCA9ICgpID0+IHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9jYXJkVHJhc2ggPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICAvL2dldCB0aGUgY2FyZCB2aWV3XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX25hbWVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fc2V0TGlrZXMoKTtcclxuICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIC8vcmV0dXJuIHRoZSBjYXJkXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcbiAgZ2V0SUQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQoKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGZvcm1FbCwgY29uZmlnKSB7XHJcbiAgICAgIHRoaXMuX2Zvcm1FbCA9IGZvcm1FbDtcclxuICAgICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gY29uZmlnLmZvcm1TZWxlY3RvcjtcclxuICAgICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTsgXHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlOyBcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTsgXHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7IFxyXG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnOyBcclxuICAgIH1cclxuICAgIFxyXG4gICAgX2NoZWNrVmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY2hhbmdlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgbGV0IGZvdW5kSW52YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICBmb3VuZEludmFsaWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGZvdW5kSW52YWxpZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja1ZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3Rvcn0pIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcclxuICAgICAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIikpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICAgICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICAgICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICBpbnB1dFZhbHVlc1tpbnB1dEVsZW1lbnQubmFtZV0gPSBpbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBzZXRMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJsb2FkaW5nLi4uXCI7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyTG9hZGluZygpIHtcclxuICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgICAgIGltZy5zcmMgPSBpbWFnZVNyYztcclxuICAgICAgICByZXR1cm4gaW1nO1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWRJbWFnZSgpIHtcclxuICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBGb3JtLmFwcGVuZChpbWFnZSk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2NvbnRhaW5lclNlbGVjdG9yfWApO1xyXG4gICAgfVxyXG4gICAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICAgIH1cclxufSIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbiAgICBcclxufTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkRm9ybSA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgdmFyaWFibGUgPSB7XHJcbi8vV3JhcHBlcnNcclxuY2FyZExpc3RFbDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKSxcclxuYWRkQ2FyZEZvcm06IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKSxcclxuXHJcblxyXG5cclxuXHJcbi8vQnV0dG9ucyBhbmQgb3RoZXIgRG9tIG5vZGVzXHJcbnByb2ZpbGVFZGl0QnV0dG9uOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIiksXHJcbnByb2ZpbGVDbG9zZUJ1dHRvbjogXCIjcHJvZmlsZS1jbG9zZS1idXR0b25cIixcclxuYWRkQ2FyZENsb3NlQnV0dG9uOiBcIiNhZGRjYXJkLWNsb3NlLWJ1dHRvblwiLFxyXG5wcm9maWxlVGl0bGU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIiksXHJcbnByb2ZpbGVEZXNjcmlwdGlvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKSxcclxuYWRkTmV3Q2FyZEJ1dHRvbjogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpLFxyXG5cclxuLy9Gb3JtIGRhdGFcclxucHJvZmlsZVRpdGxlSW5wdXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKSxcclxucHJvZmlsZURlc2NyaXB0aW9uSW5wdXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKSxcclxuXHJcbmNhcmRUaXRsZUlucHV0OiBcIiN0aXRsZS1jYXJkLWlucHV0XCIsXHJcbmNhcmRVcmxJbnB1dDogXCIjdXJsLWltYWdlLWlucHV0XCIsXHJcblxyXG4vL0ltbWFnZSBwb3B1cFxyXG5wb3B1cE1vZGFsOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLXBvcHVwXCIpLFxyXG5wb3B1cEltYWdlOiBcIiNtb2RhbC1pbWFnZS1wb3B1cFwiLFxyXG5wb3B1cFRpdGxlOiBcIiNtb2RhbC10aXRsZS1wb3B1cFwiLFxyXG5wb3B1cEltYWdlTW9kYWxDbG9zZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1wb3B1cC1jbG9zZS1idXR0b25cIiksXHJcbmRlbGV0ZUNhcmRQb3B1cDogXCIjZGVsZXRlLWNhcmQtbW9kYWxcIixcclxufSIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCJcclxuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IHtcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgY29uZmlnLFxyXG4gIHZhcmlhYmxlLFxyXG4gIGNhcmRGb3JtLFxyXG4gIHByb2ZpbGVFZGl0TW9kYWxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJhNTE3MmQ3Ni03MjA2LTRiYjYtYjYwOS0yZThlMTdiODM3MjRcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhjYXJkRGF0YSkge1xyXG4gIHBvcHVwV2l0aEltYWdlLm9wZW4oY2FyZERhdGEpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0pIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGVCdXR0b24sIGhhbmRsZUxpa2VDbGljayk7XHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpXHJcbn1cclxuXHJcblxyXG5cclxuXHJcbi8vRm9ybVZhbGlkYXRvclxyXG5jb25zdCBwcm9maWxlRWRpdE1vZGFsRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHByb2ZpbGVFZGl0TW9kYWwsY29uZmlnKTtcclxuY29uc3QgY2FyZEZvcm1Gb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY2FyZEZvcm0sIGNvbmZpZyk7XHJcblxyXG5wcm9maWxlRWRpdE1vZGFsRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmNhcmRGb3JtRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG4vL0xpa2VDYXJkXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XHJcbiAgaWYgKGNhcmQuaXNMaWtlZCkge1xyXG4gICAgYXBpXHJcbiAgICAgIC5yZW1vdmVMaWtlKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYXBpXHJcbiAgICAgIC5saWtlQ2FyZChjYXJkLl9pZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQuaGFuZGxlTGlrZUljb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgfVxyXG59XHJcblxyXG4vL1BvcHVwV2l0aEZvcm1cclxuXHJcbmZ1bmN0aW9uIG9wZW5BZGRGb3JtKCkge1xyXG4gIGNhcmRQb3B1cC5vcGVuKCk7XHJcbn1cclxuXHJcblxyXG5jb25zdCBlZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwcm9maWxlLWVkaXQtbW9kYWxcIiwgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQpO1xyXG5cclxuZnVuY3Rpb24gb3BlbkVkaXRGb3JtKCkge1xyXG4gIGNvbnN0IHVzZXIgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHZhcmlhYmxlLnByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gdXNlci5uYW1lO1xyXG4gIHZhcmlhYmxlLnByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlci5kZXNjcmlwdGlvbjtcclxuICBlZGl0UG9wdXAub3BlbigpO1xyXG59XHJcblxyXG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG52YXJpYWJsZS5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlbkVkaXRGb3JtKTtcclxuXHJcbnZhcmlhYmxlLmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5BZGRGb3JtKTsgXHJcblxyXG4vL1BvcHVwV2l0aEltYWdlXHJcblxyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1wb3B1cFwiKTtcclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vU2VjdGlvblxyXG5sZXQgc2VjdGlvbjtcclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBpdGVtczogY2FyZHMsXHJcbiAgICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgICAgY29uc3QgY2FyZEVsID0gcmVuZGVyQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBcImNhcmRzX19saXN0XCJcclxuICAgICk7XHJcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuXHJcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgfSk7XHJcblxyXG5hcGlcclxuLmdldFVzZXJJbmZvKClcclxuICAudGhlbigodXNlcikgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlci5uYW1lLCB1c2VyLmRlc2NyaXB0aW9uKTtcclxuICAgIHVzZXJJbmZvLnNldEF2YXRhcih1c2VyLmF2YXRhcik7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuLy9Vc2VySW5mb1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXCIucHJvZmlsZV9fdGl0bGVcIiwgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIiwgXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgZWRpdFBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpLmVkaXRVc2VySW5mbyhpbnB1dFZhbHVlcykudGhlbigoKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhpbnB1dFZhbHVlcy5uYW1lLCBpbnB1dFZhbHVlcy5kZXNjcmlwdGlvbik7XHJcbiAgICBlZGl0UG9wdXAuY2xvc2UoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgfSlcclxuICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICBlZGl0UG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vUG9wdXBXaXRoQ29uZmlybWF0aW9uXHJcblxyXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQnV0dG9uKGNhcmRJRCwgY2FyZCkge1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZElEKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgfSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL0VkaXRBdmF0YXJcclxuXHJcbmNvbnN0IHVwZGF0ZUF2YXRhckZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNwcm9maWxlLWltYWdlLW1vZGFsXCIsIChhdmF0YXIpID0+IHtcclxuICB1cGRhdGVBdmF0YXJGb3JtLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlQXZhdGFyKGF2YXRhci5saW5rKVxyXG4gICAgLnRoZW4oKHVzZXIpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKHVzZXIuYXZhdGFyKTtcclxuICAgICAgdXBkYXRlQXZhdGFyRm9ybS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHVwZGF0ZUF2YXRhckZvcm0uc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBlZGl0UGVuY2lsSWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWVkaXQtYnV0dG9uXCIpO1xyXG5cclxuZWRpdFBlbmNpbEljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICB1cGRhdGVBdmF0YXJGb3JtLm9wZW4oKTtcclxufSk7XHJcblxyXG51cGRhdGVBdmF0YXJGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL2FkZENhcmRcclxuXHJcbmNvbnN0IGNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2FkZC1jYXJkLW1vZGFsXCIsIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KTtcclxuXHJcbi8vIGZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuLy8gICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbi8vIH1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGNhcmREYXRhKSB7XHJcbiAgY2FyZFBvcHVwLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuYWRkTmV3Q2FyZChjYXJkRGF0YSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IHJlbmRlckNhcmQocmVzKTtcclxuICAgICAgdmFyaWFibGUuYWRkQ2FyZEZvcm0ucmVzZXQoKTtcclxuICAgICAgY2FyZEZvcm1Gb3JtVmFsaWRhdG9yLmNoYW5nZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIGNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pXHJcblxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBjYXJkUG9wdXAuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5jYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGhlYWRlcnMsIGJhc2VVcmwgfSkge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXNwb25zZSkge1xyXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFxyXG4gICAgICAgIGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfSwgVGV4dDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWBcclxuICAgICAgKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgIGBIVFRQIGVycm9yISBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfSwgVGV4dDogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWBcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgfVxyXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuaGVhZGVycyB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoZGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkaWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQgPSAoY2FyZGlkKSA9PiB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZGlkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICByZW1vdmVMaWtlKGNhcmRpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuICBlZGl0VXNlckluZm8oaW5wdXRWYWx1ZXMpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxyXG4gICAgICAgIGFib3V0OiBpbnB1dFZhbHVlcy5kZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcihpbWFnZSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGltYWdlLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3RvciggcG9wdXBTZWxlY3RvciApIHtcclxuICAgICAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZS1wb3B1cFwiKTtcclxuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3RpdGxlLXBvcHVwXCIpO1xyXG4gICAgfVxyXG4gICAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IocHJvZmlsZVRpdGxlLCBwcm9maWxlRGVzY3JpcHRpb24sIGF2YXRhclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fdGl0bGVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlVGl0bGUpO1xyXG4gICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZURlc2NyaXB0aW9uKTtcclxuICAgICAgICB0aGlzLl9hdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICBjb25zdCB1c2VySW5mbyA9IHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fdGl0bGVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gICAgfVxyXG4gICAgc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcclxuICAgICAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gICAgfVxyXG4gICAgc2V0QXZhdGFyKGF2YXRhcikge1xyXG4gICAgICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZElEIiwiY2FyZElEIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZVN1Ym1pdCIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmRUcmFzaCIsIl9jYXJkSW1hZ2VFbCIsIl9zZXRMaWtlcyIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImNhcmREYXRhIiwiaGFuZGxlRGVsZXRlQnV0dG9uIiwiaGFuZGxlTGlrZUljb24iLCJ0b2dnbGUiLCJoYW5kbGVEZWxldGVDYXJkIiwiX2VsZW1lbnQiLCJnZXRWaWV3Iiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJnZXRJRCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWwiLCJjb25maWciLCJfZm9ybUVsIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrVmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2Rpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImNoYW5nZUJ1dHRvblN0YXRlIiwiZm91bmRJbnZhbGlkIiwiX2lucHV0RWxlbWVudHMiLCJmb3JFYWNoIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImV2ZW50IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJfcmVmIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRFbHMiLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsInJlc2V0IiwiaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsInNldExvYWRpbmciLCJpc0xvYWRpbmciLCJyZW5kZXJMb2FkaW5nIiwiaW1nIiwiY3JlYXRlRWxlbWVudCIsImltYWdlU3JjIiwibG9hZEltYWdlIiwiaW1hZ2UiLCJhcHBlbmQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZEZvcm0iLCJwcm9maWxlRWRpdE1vZGFsIiwidmFyaWFibGUiLCJjYXJkTGlzdEVsIiwiYWRkQ2FyZEZvcm0iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVDbG9zZUJ1dHRvbiIsImFkZENhcmRDbG9zZUJ1dHRvbiIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImFkZE5ld0NhcmRCdXR0b24iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiY2FyZFRpdGxlSW5wdXQiLCJjYXJkVXJsSW5wdXQiLCJwb3B1cE1vZGFsIiwicG9wdXBJbWFnZSIsInBvcHVwVGl0bGUiLCJwb3B1cEltYWdlTW9kYWxDbG9zZSIsImRlbGV0ZUNhcmRQb3B1cCIsImFwaSIsImhlYWRlcnMiLCJiYXNlVXJsIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXNwb25zZSIsIm9rIiwiY29uc29sZSIsImVycm9yIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIkVycm9yIiwianNvbiIsIl9yZXF1ZXN0IiwidXJsIiwib3B0aW9ucyIsImZldGNoIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsImFkZE5ld0NhcmQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImRlbGV0ZUNhcmQiLCJjYXJkaWQiLCJsaWtlQ2FyZCIsInJlbW92ZUxpa2UiLCJnZXRVc2VySW5mbyIsImVkaXRVc2VySW5mbyIsImFib3V0IiwiZGVzY3JpcHRpb24iLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwicG9wdXBXaXRoSW1hZ2UiLCJyZW5kZXJDYXJkIiwiaXRlbSIsInByb2ZpbGVFZGl0TW9kYWxGb3JtVmFsaWRhdG9yIiwiY2FyZEZvcm1Gb3JtVmFsaWRhdG9yIiwiY2FyZCIsImNhdGNoIiwiZXJyIiwiZWRpdFBvcHVwIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImZpbmFsbHkiLCJ1c2VyIiwiY2FyZFBvcHVwIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBUaXRsZSIsInNlY3Rpb24iLCJjYXJkcyIsImNhcmRFbCIsInNldEF2YXRhciIsImF2YXRhclNlbGVjdG9yIiwiX3RpdGxlRWxlbWVudCIsIl9kZXNjcmlwdGlvbkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsImxvZyIsInVwZGF0ZUF2YXRhckZvcm0iLCJyZXMiXSwic291cmNlUm9vdCI6IiJ9